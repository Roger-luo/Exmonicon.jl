import{_ as s,c as a,o as e,a as n}from"./app.17aa78ac.js";const u=JSON.parse('{"title":"What is meta-programming","description":"","frontmatter":{},"headers":[{"level":2,"title":"Why use Expronicon?","slug":"why-use-expronicon","link":"#why-use-expronicon","children":[]},{"level":2,"title":"Meta-programming in Julia","slug":"meta-programming-in-julia","link":"#meta-programming-in-julia","children":[]},{"level":2,"title":"Evaluating expressions","slug":"evaluating-expressions","link":"#evaluating-expressions","children":[]},{"level":2,"title":"Building expressions","slug":"building-expressions","link":"#building-expressions","children":[]},{"level":2,"title":"Defining macros","slug":"defining-macros","link":"#defining-macros","children":[]},{"level":2,"title":"Learn more about expressions","slug":"learn-more-about-expressions","link":"#learn-more-about-expressions","children":[]}],"relativePath":"intro/what-is-metaprogramming.md","lastUpdated":1670998942000}'),o={name:"intro/what-is-metaprogramming.md"},l=n(`<h1 id="what-is-meta-programming" tabindex="-1">What is meta-programming <a class="header-anchor" href="#what-is-meta-programming" aria-hidden="true">#</a></h1><p>This introduction is aimed for people who are new to Julia and meta-programming. If you are already familiar with Julia and meta-programming, you can skip this section. If you are new to Julia, you can read the <a href="https://docs.julialang.org/en/v1/manual/introduction/" target="_blank" rel="noreferrer">Julia documentation</a> to learn more about the language.</p><p>Meta-programming is a programming technique in which computer programs have the ability to treat programs as their data. In other words, a part of the program is able to read and manipulate other parts of itself while it is running.</p><p>Julia has a powerful meta-programming system that allows you to write Julia functions that generate other Julia program. This is a very powerful technique that can be used to implement many language features, such as reflection, and code generation. It is also a powerful tool for building domain-specific languages (DSLs).</p><h2 id="why-use-expronicon" tabindex="-1">Why use Expronicon? <a class="header-anchor" href="#why-use-expronicon" aria-hidden="true">#</a></h2><p>The <code>Expronicon</code> package provides a set of tools for working with Julia expressions. It gives you the ability to build, inspect, and manipulate Julia expressions. It also provides a set of macros that make it easy to work with expressions. It makes your code more readable and easier to maintain.</p><h2 id="meta-programming-in-julia" tabindex="-1">Meta-programming in Julia <a class="header-anchor" href="#meta-programming-in-julia" aria-hidden="true">#</a></h2><p>Julia&#39;s meta-programming system is based on the idea of <em>expressions</em>. An expression is a piece of code that can be evaluated to produce a value. For example, the expression <code>1 + 2</code> evaluates to the value <code>3</code>. Expressions can be nested, so <code>1 + 2 * 3</code> evaluates to <code>7</code>.</p><p>Expressions are represented in Julia by the <code>Expr</code> type. You can create an expression using the quoting syntax:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> :(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    :(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>The <code>:(...)</code> syntax is called a <em>quotation</em> and it creates an expression. The expression <code>:(1 + 2)</code> is equivalent to the expression <code>Expr(:call, :+, 1, 2)</code>. The <code>Expr</code> constructor takes a <em>head</em> and zero or more <em>arguments</em>. The head is a symbol that describes the type of expression. The arguments are the values that the expression operates on. For example, the expression <code>1 + 2</code> has the head <code>:call</code> and the arguments <code>:+</code> and <code>1</code> and <code>2</code>.</p><p>You can use the <code>dump</code> function to see the structure of an expression:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dump</span><span style="color:#A6ACCD;">(:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">Expr</span></span>
<span class="line"><span style="color:#A6ACCD;">  head</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Symbol call</span></span>
<span class="line"><span style="color:#A6ACCD;">  args</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Array</span><span style="color:#FFCB6B;">{Any}</span><span style="color:#A6ACCD;">((</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">,))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Symbol </span><span style="color:#89DDFF;">+</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Int64 </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Int64 </span><span style="color:#F78C6C;">2</span></span>
<span class="line"></span></code></pre></div><p>The <code>dump</code> function prints the type of the expression, the head, and the arguments. The arguments are printed recursively, so you can see the structure of nested expressions.</p><h2 id="evaluating-expressions" tabindex="-1">Evaluating expressions <a class="header-anchor" href="#evaluating-expressions" aria-hidden="true">#</a></h2><p>Although, this is <strong>usually not recommended inside a function definition</strong>, you can use the <code>eval</code> function to evaluate an expression:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">eval</span><span style="color:#A6ACCD;">(:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#F78C6C;">2</span></span>
<span class="line"></span></code></pre></div><p>or you can use the <code>@eval</code> macro:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@eval</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">2</span></span>
<span class="line"></span></code></pre></div><p>The <code>@eval</code> macro is equivalent to <code>eval(:(...))</code>. The <code>@eval</code> macro is useful when you want to evaluate an expression that contains variables:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> b </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@eval</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> b</span></span>
<span class="line"><span style="color:#F78C6C;">3</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>The <code>@eval</code> macro is useful when you want to generate code during precompilation of a package. For example, the <code>@eval</code> macro is used in the <a href="https://yaoquantum.org" target="_blank" rel="noreferrer">Yao.jl</a> to generate the <code>mat</code> function for each gate type:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> T </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> [:(RotationGate{D,</span><span style="color:#89DDFF;">&lt;:</span><span style="color:#FFCB6B;">SymReal</span><span style="color:#A6ACCD;">} </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> D), :(PhaseGate{</span><span style="color:#89DDFF;">&lt;:</span><span style="color:#FFCB6B;">SymReal</span><span style="color:#A6ACCD;">}), :(ShiftGate{</span><span style="color:#89DDFF;">&lt;:</span><span style="color:#FFCB6B;">SymReal</span><span style="color:#A6ACCD;">})]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">@eval</span><span style="color:#A6ACCD;"> YaoBlocks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mat</span><span style="color:#A6ACCD;">(gate</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">$T</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mat</span><span style="color:#A6ACCD;">(Basic, gate)</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"></span></code></pre></div><h2 id="building-expressions" tabindex="-1">Building expressions <a class="header-anchor" href="#building-expressions" aria-hidden="true">#</a></h2><p>You can use the <code>Expr</code> constructor to build expressions:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Expr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">:call</span><span style="color:#A6ACCD;">, :</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>The <code>Expr</code> constructor takes a head and zero or more arguments. The head is a symbol that describes the type of expression. The arguments are the values that the expression operates on. For example, the expression <code>1 + 2</code> has the head <code>:call</code> and the arguments <code>:+</code> and <code>1</code> and <code>2</code>.</p><p>Or you can use interpolation to build expressions:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> :(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>The <code>$(...)</code> syntax is called an <em>interpolation</em>. It evaluates the expression inside the parentheses and inserts the result into the expression. The <code>$(2 * 3)</code> expression is evaluated to the value <code>6</code>, which is inserted into the expression <code>:(1 + 6)</code>.</p><h2 id="defining-macros" tabindex="-1">Defining macros <a class="header-anchor" href="#defining-macros" aria-hidden="true">#</a></h2><p><code>macro</code> is a special Julia function that is executed at compile time. It takes an expression as an argument and returns an expression. For example, the following macro takes an expression and returns an expression that evaluates to the same value:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">macro</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">identity</span><span style="color:#A6ACCD;">(ex)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> ex</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"></span></code></pre></div><p>You can inspect the returned expression using the <code>@macroexpand</code> macro:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@macroexpand</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@identity</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#A6ACCD;">:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>The <code>@macroexpand</code> macro is useful for debugging macros. It prints the expression that will be evaluated instead of the expression that was passed to the macro.</p><p>You can use the <code>@macroexpand</code> macro to see how the <code>@eval</code> macro is implemented:</p><div class="language-julia"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">julia</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@macroexpand</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">@eval</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">:(Core</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">eval</span><span style="color:#A6ACCD;">(Main, </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">Expr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">:copyast</span><span style="color:#A6ACCD;">, :(</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">QuoteNode</span><span style="color:#A6ACCD;">(:(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">))))))))</span></span>
<span class="line"></span></code></pre></div><h2 id="learn-more-about-expressions" tabindex="-1">Learn more about expressions <a class="header-anchor" href="#learn-more-about-expressions" aria-hidden="true">#</a></h2><p>For more information about Julia expression itself, see the <a href="https://docs.julialang.org/en/v1/manual/metaprogramming/" target="_blank" rel="noreferrer">Meta Programming</a> section of the Julia manual.</p>`,40),p=[l];function t(r,c,i,C,y,d){return e(),a("div",null,p)}const D=s(o,[["render",t]]);export{u as __pageData,D as default};
